
proc createContext { splunk_home login passwd index name scope terms uom type min max count avg stdev response} {
    send "$splunk_home/bin/splunk search 'index=$index | xsCreateContext terms=\"$terms\" name=$name type=$type avg=$avg count=$count max=$max min=$min stdev=$stdev uom=$uom scope=$scope' -auth $login:$passwd -output table \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsCreateContext ($name $scope $type) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsCreateContext ($name $scope $type)" }
    }
}

proc createContextDomain { splunk_home login passwd index name scope terms uom type min max count response} {
    send "$splunk_home/bin/splunk search 'index=$index | xsCreateContext terms=\"$terms\" name=$name type=$type count=$count max=$max min=$min uom=$uom scope=$scope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsCreateContext ($name $scope domain) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsCreateContext ($name $scope domain)" }
    }
}

proc createContextAverageCentered { splunk_home login passwd index name scope terms uom type avg stdev response} {
    send "$splunk_home/bin/splunk search 'index=$index | xsCreateContext terms=\"$terms\" name=$name type=$type avg=$avg stdev=$stdev uom=$uom scope=$scope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsCreateContext ($name $scope average_centered) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsCreateContext ($name $scope average_centered)" }
    }
}

proc createUDContext { splunk_home login passwd name scope terms uom type min max count avg stdev response} {

    send "$splunk_home/bin/splunk search '| xsCreateUDContext terms=\"$terms\" name=$name type=$type avg=$avg count=$count max=$max min=$min stdev=$stdev uom=$uom scope=$scope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsCreateUDContext ($name $scope $type) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsCreateUDContext ($name $scope $type)" }
    }
}

proc createUDContextDomain { splunk_home login passwd name scope terms uom type min max count response} {

    send "$splunk_home/bin/splunk search '| xsCreateUDContext terms=\"$terms\" name=$name type=$type count=$count max=$max min=$min uom=$uom scope=$scope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsCreateUDContext ($name $scope domain) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsCreateUDContext ($name $scope domain)" }
    }
}

proc createUDContextAverageCentered { splunk_home login passwd name scope terms uom type avg stdev response} {

    send "$splunk_home/bin/splunk search '| xsCreateUDContext terms=\"$terms\" name=$name type=$type avg=$avg stdev=$stdev uom=$uom scope=$scope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsCreateUDContext ($name $scope average_centered) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsCreateUDContext ($name $scope average_centered)" }
    }
}

proc updateContext { splunk_home login passwd index name scope terms uom type min max count avg stdev response} {
    send "$splunk_home/bin/splunk search 'index=$index | xsUpdateContext terms=\"$terms\" name=$name type=$type avg=$avg count=$count max=$max min=$min stdev=$stdev uom=$uom scope=$scope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsUpdateContext ($name $scope $type) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsUpdateContext ($name $scope $type)" }
    }
}

proc updateUDContext { splunk_home login passwd name scope terms uom type min max count avg stdev response} {

    send "$splunk_home/bin/splunk search '| xsUpdateUDContext terms=\"$terms\" name=$name type=$type avg=$avg count=$count max=$max min=$min stdev=$stdev uom=$uom scope=$scope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsUpdateUDContext ($name $scope $type) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsUpdateUDContext ($name $scope $type)" }
    }
}

proc deleteContext { splunk_home login passwd name scope response} {

    send "$splunk_home/bin/splunk search '| xsDeleteContext $name IN $scope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsDeleteContext ($name $scope) - TIMEOUT" }
        "Context $name successfully deleted" { send_user "\nTEST PASS - xsDeleteContext ($name)" }
        "$response" { send_user "\nTEST PASS - xsDeleteContext ($name $scope)" }
    }
}

proc cloneContext { splunk_home login passwd incontext inscope tocontext toscope response} {

    send "$splunk_home/bin/splunk search '| xsCloneContext $incontext IN $inscope TO $tocontext IN $toscope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsCloneContext ($incontext $inscope $tocontext $toscope) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsCloneContext ($incontext $inscope $tocontext $toscope)" }
    }
}

proc renameContext { splunk_home login passwd incontext inscope tocontext toscope response} {

    send "$splunk_home/bin/splunk search '| xsRenameContext $incontext IN $inscope TO $tocontext IN $toscope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsRenameContext ($incontext $inscope $tocontext $toscope) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsRenameContext ($incontext $inscope $tocontext $toscope)" }
    }
}

proc displayContext { splunk_home login passwd context scope response} {

    send "$splunk_home/bin/splunk search '| xsDisplayContext $context IN $scope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsDisplayContext ($context $scope) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsDisplayContext ($context $scope)" }
    }
}

proc listContexts { splunk_home login passwd scope response} {

    send "$splunk_home/bin/splunk search '| xsListContexts $scope | sort context' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsListContexts ($scope) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsListContexts ($scope)" }
    }
}

proc listUOM { splunk_home login passwd context scope response} {

    send "$splunk_home/bin/splunk search '| xsListUOM FROM $context IN $scope' -auth $login:$passwd \r"

    expect {
        timeout { send_user "\nTEST FAIL - xsListUOM ($context $scope) - TIMEOUT" }
        "$response" { send_user "\nTEST PASS - xsListUOM ($context $scope)" }
    }
}
