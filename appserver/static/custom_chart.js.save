/*
 * A custom chart example based on the d3chartview of the web framework.
 * The component is initialized in Javascript which provides more flexibility and formatting options.
 */
require([
    'underscore',
    'jquery',
    'splunkjs/mvc/utils',
    'splunkjs/mvc',
    'splunkjs/mvc/d3chart/d3chartview',
    'util/moment',
    'splunkjs/mvc/simplexml/ready!'
], function(_, $, utils, mvc, D3ChartView, moment) {

    // Re-use the search manager of the results table
    var tableManagerid = mvc.Components.get('table1').settings.get('managerid');

    // Create the D3 chart view
    var chart = new D3ChartView({
        "id": "chart1",
        "managerid": tableManagerid,
        "type": "discreteBarChart",
        "el": $('#chart1')
    }).render();

    chart.settings.set("setup", function(chart) {
        // Configure chart formatting
        chart.color(d3.scale.category10().range());
        chart.margin({right: 100, left: 80, top: 70, bottom: 70 });

        // Format the X-Axis labels
        chart.xAxis.rotateLabels(45);
        chart.xAxis.axisLabel("Domain");
    });

});
